{
  "type": "object",
  "description": "Represents a relationship between a file and a business entity (e.g., invoice, message, appointment). This allows files to be attached to various entities across the platform. When a file has at least one active relation, its status becomes 'linked' and it is protected from cleanup jobs.",
  "properties": {
    "uid": {
      "type": "string",
      "readOnly": true,
      "description": "Unique identifier for the file-entity relation record (e.g., \"rel_123abc\")."
    },
    "file_uid": {
      "type": "string",
      "description": "Unique identifier of the file being linked (e.g., \"file_456def\"). Must reference an existing file with status 'scanned', 'uploaded', or 'linked'."
    },
    "entity_type": {
      "type": "string",
      "enum": [
        "message",
        "invoice",
        "estimate",
        "appointment",
        "client",
        "contact",
        "payment"
      ],
      "description": "Type of entity the file is attached to. **message**: email message. **invoice**: Invoice document. **estimate**: Estimate/quote document. **appointment**: Scheduled appointment. **client**: Client profile. **contact**: Contact record. **payment**: Payment record. **credit_note**: Credit note document. **staff_member**: Staff member profile. **business**: Business profile."
    },
    "entity_uid": {
      "type": "string",
      "description": "Unique identifier of the entity the file is attached to (e.g., \"inv_789xyz\" for an invoice, \"msg_123abc\" for a message)."
    },
    "business_uid": {
      "type": "string",
      "readOnly": true,
      "description": "Unique identifier of the business that owns both the file and the entity (e.g., \"biz_456xyz\"). Inherited from the file record."
    },
    "client_uid": {
      "type": "string",
      "nullable": true,
      "description": "Unique identifier of the client associated with this relation, if applicable (e.g., \"client_789abc\"). Used for client-specific files like uploaded documents or images. Null for business-level files."
    },
    "created_at": {
      "type": "string",
      "format": "date-time",
      "readOnly": true,
      "description": "Timestamp when the relation was created, in ISO 8601 format (e.g., \"2026-01-27T10:35:00Z\")."
    },
    "updated_at": {
      "type": "string",
      "format": "date-time",
      "readOnly": true,
      "description": "Timestamp when the relation was last updated, in ISO 8601 format (e.g., \"2026-01-27T10:35:30Z\")."
    },
    "deleted_at": {
      "type": "string",
      "format": "date-time",
      "nullable": true,
      "readOnly": true,
      "description": "Timestamp when the relation was soft deleted, in ISO 8601 format (e.g., \"2026-01-27T12:00:00Z\"). Null if the relation is still active. When all relations for a file are deleted, the file may become eligible for cleanup."
    }
  },
  "required": [
    "uid",
    "file_uid",
    "entity_type",
    "entity_uid",
    "business_uid",
    "created_at",
    "updated_at"
  ],
  "example": {
    "uid": "rel_abc123def456",
    "file_uid": "file_789xyz",
    "entity_type": "invoice",
    "entity_uid": "inv_456abc",
    "business_uid": "biz_123xyz",
    "client_uid": "client_789def",
    "created_at": "2026-01-27T10:35:00Z",
    "updated_at": "2026-01-27T10:35:00Z",
    "deleted_at": null
  }
}
