{
  "type": "object",
  "properties": {
    "uid": {
      "type": "string",
      "description": "The unique identifier (UID) of the business rule"
    },
    "business_uid": {
      "type": "string",
      "description": "The unique identifier (UID) of the business that owns this rule"
    },
    "category": {
      "type": "string",
      "description": "The category of the business rule",
      "enum": [
        "tone_of_voice",
        "business_policies",
        "things_to_avoid",
        "faq"
      ]
    },
    "content": {
      "type": "string",
      "description": "The content/text of the business rule"
    },
    "status": {
      "type": "string",
      "description": "The current status of the business rule",
      "enum": [
        "active",
        "pending_approval",
        "inactive"
      ]
    },
    "source": {
      "type": "string",
      "description": "Whether the rule was created by the system (AI-generated) or by a user",
      "enum": [
        "system",
        "user"
      ]
    },
    "created_by_staff_uid": {
      "type": "string",
      "description": "The UID of the staff member who created the rule",
      "nullable": true
    },
    "updated_by_staff_uid": {
      "type": "string",
      "description": "The UID of the staff member who last updated the rule",
      "nullable": true
    },
    "sort_order": {
      "type": "integer",
      "description": "Sort order for displaying rules within a category"
    },
    "metadata": {
      "type": "object",
      "description": "Additional metadata associated with the rule. For FAQ rules, includes structured `question` and `answer` fields. For all system-generated rules, may include `confidence`, `reasoning`, and `evidence`.",
      "nullable": true,
      "properties": {
        "question": {
          "type": "string",
          "description": "The question part of an FAQ rule (only present for `faq` category rules)"
        },
        "answer": {
          "type": "string",
          "description": "The answer part of an FAQ rule (only present for `faq` category rules)"
        },
        "confidence": {
          "type": "number",
          "description": "AI confidence score (0.0 to 1.0) for system-generated rules"
        },
        "reasoning": {
          "type": "string",
          "description": "AI-generated reasoning for why this rule was created"
        },
        "evidence": {
          "type": "array",
          "description": "Evidence from conversations supporting this rule",
          "items": {
            "type": "object",
            "properties": {
              "client_uid": { "type": "string" },
              "message_uid": { "type": "string" },
              "quote": { "type": "string" },
              "speaker": { "type": "string", "enum": ["staff", "client"] }
            }
          }
        }
      }
    },
    "created_at": {
      "type": "string",
      "format": "date-time",
      "description": "Date the business rule was created"
    },
    "updated_at": {
      "type": "string",
      "format": "date-time",
      "description": "Date the business rule was last updated"
    }
  },
  "required": [
    "uid",
    "business_uid",
    "category",
    "content",
    "status",
    "source",
    "sort_order",
    "created_at",
    "updated_at"
  ],
  "examples": [
    {
      "summary": "Tone of voice rule",
      "value": {
        "uid": "br-a1b2c3d4-5678-90ef-ghij-klmnopqrstuv",
        "business_uid": "biz-1234abcd-5678-90ef-ghij-klmnopqrstuv",
        "category": "tone_of_voice",
        "content": "Always use a friendly and professional tone when communicating with clients",
        "status": "active",
        "source": "system",
        "created_by_staff_uid": "stf-9876wxyz-5432-10ab-cdef-ghijklmnopqr",
        "updated_by_staff_uid": null,
        "sort_order": 0,
        "metadata": {
          "confidence": 0.92,
          "reasoning": "Consistent friendly tone observed across 15 client conversations"
        },
        "created_at": "2024-12-15T10:30:00.000Z",
        "updated_at": "2024-12-15T10:30:00.000Z"
      }
    },
    {
      "summary": "FAQ rule with structured question and answer",
      "value": {
        "uid": "br-e5f6a7b8-9012-34cd-efgh-ijklmnopqrst",
        "business_uid": "biz-1234abcd-5678-90ef-ghij-klmnopqrstuv",
        "category": "faq",
        "content": "Q: What are your business hours? A: We are open Monday to Friday, 9 AM to 5 PM.",
        "status": "active",
        "source": "system",
        "created_by_staff_uid": "stf-9876wxyz-5432-10ab-cdef-ghijklmnopqr",
        "updated_by_staff_uid": null,
        "sort_order": 1,
        "metadata": {
          "question": "What are your business hours?",
          "answer": "We are open Monday to Friday, 9 AM to 5 PM.",
          "confidence": 0.87,
          "reasoning": "Detected consistent business hours mentioned across multiple client conversations"
        },
        "created_at": "2024-12-15T11:00:00.000Z",
        "updated_at": "2024-12-15T11:00:00.000Z"
      }
    }
  ],
  "description": "Represents a business rule that guides AI behavior for a specific business. Rules are organized by category and can be AI-generated or user-created. For FAQ category rules, the metadata contains structured `question` and `answer` fields extracted from the content."
}
