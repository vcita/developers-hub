{
  "type": "object",
  "description": "Represents a business rule that guides AI behavior for a specific business. Rules are organized by category (tone of voice, business policies, things to avoid, FAQ) and can be AI-generated (system) or user-created. For FAQ category rules, the metadata contains structured question and answer fields extracted from the content. Rules can be activated, deactivated, or held in a pending approval state.",
  "properties": {
    "uid": {
      "type": "string",
      "readOnly": true,
      "description": "The unique identifier (UID) of the business rule (e.g., \"br-a1b2c3d4-5678-90ef-ghij-klmnopqrstuv\"). Assigned automatically by the system upon creation."
    },
    "business_uid": {
      "type": "string",
      "readOnly": true,
      "description": "The unique identifier (UID) of the business that owns this rule (e.g., \"biz-1234abcd-5678-90ef-ghij-klmnopqrstuv\"). Automatically set based on the authenticated token."
    },
    "content": {
      "type": "string",
      "description": "The content or text of the business rule (e.g., \"Always use a friendly and professional tone when communicating with clients\"). For FAQ rules, this typically contains both the question and answer in a combined format."
    },
    "status": {
      "type": "string",
      "description": "The current status of the business rule, controlling whether the AI agent actively uses it.\n\n* `active` - The rule is currently in effect and will be used by the AI agent.\n* `pending_approval` - The rule has been suggested (typically by the system) and is awaiting staff review before becoming active.\n* `inactive` - The rule has been deactivated and will not be used by the AI agent.",
      "enum": [
        "active",
        "pending_approval",
        "inactive"
      ]
    },
    "source": {
      "type": "string",
      "readOnly": true,
      "description": "Indicates whether the rule was created by the AI system or by a user (staff member).\n\n* `system` - The rule was generated automatically by the AI based on analysis of business conversations.\n* `user` - The rule was manually created or edited by a staff member.",
      "enum": [
        "system",
        "user"
      ]
    },
    "created_by_staff_uid": {
      "type": "string",
      "readOnly": true,
      "description": "The UID of the staff member who created the rule (e.g., \"stf-9876wxyz-5432-10ab-cdef-ghijklmnopqr\"). Will be null for system-generated rules that have not been manually edited.",
      "nullable": true
    },
    "updated_by_staff_uid": {
      "type": "string",
      "readOnly": true,
      "description": "The UID of the staff member who last updated the rule (e.g., \"stf-9876wxyz-5432-10ab-cdef-ghijklmnopqr\"). Will be null if the rule has never been updated by a staff member.",
      "nullable": true
    },
    "sort_order": {
      "type": "integer",
      "description": "Sort order for displaying rules within a category (e.g., 0). Lower values appear first. Rules within the same category are ordered by this field in ascending order."
    },
    "metadata": {
      "type": "object",
      "description": "Additional metadata associated with the rule. For FAQ rules, includes structured `question` and `answer` fields. For system-generated rules, may include `confidence`, `reasoning`, and `evidence` from the AI analysis.",
      "nullable": true,
      "properties": {
        "question": {
          "type": "string",
          "description": "The question part of an FAQ rule (e.g., \"What are your business hours?\"). Only present for rules with category `faq`."
        },
        "answer": {
          "type": "string",
          "description": "The answer part of an FAQ rule (e.g., \"We are open Monday to Friday, 9 AM to 5 PM.\"). Only present for rules with category `faq`."
        },
        "confidence": {
          "type": "number",
          "description": "AI confidence score ranging from 0.0 to 1.0 indicating how confident the system is about this rule (e.g., 0.92). Only present for system-generated rules."
        },
        "reasoning": {
          "type": "string",
          "description": "AI-generated reasoning explaining why this rule was created or suggested (e.g., \"Consistent friendly tone observed across 15 client conversations\"). Only present for system-generated rules."
        },
        "evidence": {
          "type": "array",
          "description": "Evidence from conversations that supports this rule. Contains quotes and references from actual client-staff interactions.",
          "items": {
            "type": "object",
            "properties": {
              "client_uid": {
                "type": "string",
                "description": "The UID of the client involved in the conversation."
              },
              "message_uid": {
                "type": "string",
                "description": "The UID of the specific message used as evidence."
              },
              "quote": {
                "type": "string",
                "description": "A direct quote from the conversation used as evidence."
              },
              "speaker": {
                "type": "string",
                "enum": [
                  "staff",
                  "client"
                ],
                "description": "Identifies whether the quote is from a staff member or a client.\n\n* `staff` - The quote is from a staff member.\n* `client` - The quote is from a client."
              }
            }
          }
        }
      }
    },
    "created_at": {
      "type": "string",
      "format": "date-time",
      "readOnly": true,
      "description": "The date and time when the business rule was created, in ISO 8601 format (e.g., \"2024-12-15T10:30:00.000Z\")."
    },
    "updated_at": {
      "type": "string",
      "format": "date-time",
      "readOnly": true,
      "description": "The date and time when the business rule was last updated, in ISO 8601 format (e.g., \"2024-12-16T14:00:00.000Z\")."
    },
    "category_code": {
      "type": "string",
      "description": "The category of the business rule. Determines how the AI agent uses this rule.\n\n* `tone_of_voice` - Rules about communication style, language, and tone the AI should adopt when interacting with clients.\n* `policies_and_info` - Rules about business operations, pricing, scheduling policies, and other operational guidelines.\n* `things_to_avoid` - Rules about topics, phrases, or actions the AI should not mention or perform.\n* `faq` - Frequently asked questions and their answers. When this category is used, the metadata field should contain structured `question` and `answer` fields.",
      "enum": [
        "tone_of_voice",
        "policies_and_info",
        "things_to_avoid",
        "faq"
      ]
    }
  },
  "required": [
    "uid",
    "business_uid",
    "category_code",
    "content",
    "status",
    "source",
    "sort_order",
    "created_at",
    "updated_at"
  ],
  "example": {
    "uid": "br-a1b2c3d4-5678-90ef-ghij-klmnopqrstuv",
    "business_uid": "biz-1234abcd-5678-90ef-ghij-klmnopqrstuv",
    "content": "Always use a friendly and professional tone when communicating with clients",
    "status": "active",
    "source": "system",
    "created_by_staff_uid": "stf-9876wxyz-5432-10ab-cdef-ghijklmnopqr",
    "updated_by_staff_uid": null,
    "sort_order": 0,
    "metadata": {
      "confidence": 0.92,
      "reasoning": "Consistent friendly tone observed across 15 client conversations"
    },
    "created_at": "2024-12-15T10:30:00.000Z",
    "updated_at": "2024-12-15T10:30:00.000Z",
    "category_code": "tone_of_voice"
  }
}